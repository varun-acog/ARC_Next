"use strict";(()=>{var e={};e.id=76,e.ids=[76],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2467:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var o={};t.r(o),t.d(o,{POST:()=>p});var r=t(9303),n=t(8716),a=t(670),i=t(7070);let c=process.env.LDAP_USERNAME,l=process.env.LDAP_PASSWORD;async function p(e){try{console.log("Handling compare request...");let s=(await e.formData()).get("session_id");if(console.log("Compare - Session ID:",s),!s)return console.log("Error: Session ID is required"),i.NextResponse.json({error:"Session ID is required"},{status:400});if(!c||!l)return console.log("Error: LDAP credentials are missing in environment variables"),i.NextResponse.json({error:"LDAP credentials are missing in environment variables"},{status:500});let t=`${c}:${l}`,o="Basic "+Buffer.from(t).toString("base64");console.log("Basic Auth header prepared (redacted for security)"),console.log("Checking session status...");let r=await fetch(`https://demo-legal-llm-backend-1.hpc4.aganitha.ai/api/session/${s}/status`,{method:"GET",headers:{Accept:"application/json",Authorization:o}});if(console.log("Session status response status:",r.status),!r.ok){let e=r.headers.get("Content-Type"),s="Failed to check session status",t={};return s=e&&e.includes("application/json")?(t=await r.json()).error||s:`${s} (Status: ${r.status} ${r.statusText})`,console.log("Session status error details:",t),console.log("Session status error:",s),i.NextResponse.json({error:s,details:t},{status:r.status})}let n=await r.json();if(console.log("Session status:",n),!n.has_reference_doc||!n.has_review_doc)return console.log("Error: Session is not ready for comparison - missing documents"),i.NextResponse.json({error:"Session is not ready for comparison - missing reference or review document"},{status:400});console.log("Calling external endpoint to compare documents...");let a=new URLSearchParams;a.append("session_id",s);let p=await fetch("https://demo-legal-llm-backend-1.hpc4.aganitha.ai/api/contracts/compare",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded",Authorization:o},body:a});if(console.log("External endpoint response status:",p.status),!p.ok){let e=p.headers.get("Content-Type"),s="Failed to compare documents via external endpoint",t={};return s=e&&e.includes("application/json")?(t=await p.json()).error||s:`${s} (Status: ${p.status} ${p.statusText})`,console.log("External endpoint error details:",t),console.log("External endpoint error:",s),i.NextResponse.json({error:s,details:t},{status:p.status})}let u=await p.json();return console.log("External endpoint comparison result:",u),i.NextResponse.json(u,{status:200})}catch(e){return console.error("Compare error:",e.message),i.NextResponse.json({error:"Internal server error"},{status:500})}}let u=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/contracts/compare/route",pathname:"/api/contracts/compare",filename:"route",bundlePath:"app/api/contracts/compare/route"},resolvedPagePath:"/Users/varun/work/ARC_Next/app/api/contracts/compare/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:g}=u,h="/api/contracts/compare/route";function x(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),o=s.X(0,[276,972],()=>t(2467));module.exports=o})();