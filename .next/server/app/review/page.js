(()=>{var e={};e.id=672,e.ids=[672],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5227:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),a(1239),a(218),a(5866);var s=a(3191),r=a(8716),l=a(7922),n=a.n(l),o=a(5231),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);a.d(t,i);let d=["",{children:["review",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1239)),"/Users/varun/work/ARC_Next/app/review/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,218)),"/Users/varun/work/ARC_Next/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/varun/work/ARC_Next/app/review/page.tsx"],u="/review/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/review/page",pathname:"/review",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7688:(e,t,a)=>{Promise.resolve().then(a.bind(a,3850)),Promise.resolve().then(a.bind(a,7680))},9574:(e,t,a)=>{Promise.resolve().then(a.bind(a,8040))},2955:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2994,23)),Promise.resolve().then(a.t.bind(a,6114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,9671,23)),Promise.resolve().then(a.t.bind(a,1868,23)),Promise.resolve().then(a.t.bind(a,4759,23))},3850:(e,t,a)=>{"use strict";a.d(t,{default:()=>c});var s=a(326);a(7577);var r=a(434),l=a(5047),n=a(6283),o=a(1739),i=a(3578),d=a(6226);let c=()=>{let e=(0,l.usePathname)(),t=[{path:"/",label:"Home",icon:null},{path:"/generate",label:"Generate Contract",icon:n.Z},{path:"/review",label:"Evaluate Contract",icon:o.Z},{path:"/compare",label:"Compare Contracts",icon:i.Z}];return s.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[s.jsx("div",{className:"flex items-center space-x-8",children:s.jsx(r.default,{href:"/",className:"flex items-center space-x-3",children:s.jsx(d.default,{src:"https://www.aganitha.ai/wp-content/uploads/2023/05/aganitha-logo.png",alt:"Aganitha Logo",width:128,height:128,className:"object-contain max-h-10 w-auto",quality:100,priority:!0})})}),s.jsx("nav",{className:"flex space-x-8",children:t.map(t=>{let a=t.icon,l=e===t.path;return(0,s.jsxs)(r.default,{href:t.path,className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${l?"text-blue-700 bg-blue-50":"text-gray-600 hover:text-blue-700 hover:bg-gray-50"}`,children:[a&&s.jsx(a,{className:"w-4 h-4"}),s.jsx("span",{children:t.label})]},t.path)})})]})})})}},7680:(e,t,a)=>{"use strict";a.d(t,{DocumentProvider:()=>n,s:()=>o});var s=a(326),r=a(7577);let l=(0,r.createContext)(void 0),n=({children:e})=>{let[t,a]=(0,r.useState)(null),[n,o]=(0,r.useState)(null),[i,d]=(0,r.useState)(null),[c,u]=(0,r.useState)([]);return s.jsx(l.Provider,{value:{generateDocument:t,setGenerateDocument:a,reviewDocument:n,setReviewDocument:o,compareDocument:i,setCompareDocument:d,documents:c,addDocument:e=>{u(t=>[...t.filter(t=>t.id!==e.id),e])}},children:e})},o=()=>{let e=(0,r.useContext)(l);if(!e)throw Error("useDocuments must be used within a DocumentProvider");return e}},8040:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(326),r=a(7577),l=a(361);let n=(0,a(2881).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var o=a(1739),i=a(6283),d=a(4019),c=a(3685),u=a(7680);let p=()=>{let{reviewDocument:e,setReviewDocument:t,addDocument:a}=(0,u.s)(),[p,m]=(0,r.useState)(null),[x,h]=(0,r.useState)(""),[g,v]=(0,r.useState)(!1),[y,f]=(0,r.useState)([]),[b,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[_,A]=(0,r.useState)(null),[S,P]=(0,r.useState)(!1),[k,C]=(0,r.useState)([{value:"msa",label:"Master Service Agreement (MSA)"},{value:"nda",label:"Non-Disclosure Agreement (NDA)"},{value:"sla",label:"Service Level Agreement (SLA)"},{value:"employment",label:"Employment Contract"},{value:"vendor",label:"Vendor Agreement"}]),D=(0,r.useRef)(null);(0,r.useEffect)(()=>{E(),U()},[]),(0,r.useEffect)(()=>{if(e&&!p){console.log("Setting contract type from reviewDocument:",e.type),h(e.type),m(e.file||null);let t=e.metadata;t?.session_id&&(w(t.session_id),A({message:"File uploaded successfully",session_id:t.session_id,filename:e.name}))}},[e,p]);let E=async()=>{try{let e=await fetch("/api/templates",{method:"GET",headers:{Accept:"application/json"}});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to fetch templates")}let t=await e.json();console.log("Templates response:",t);let a=[];if(Array.isArray(t))a=t;else if(t.templates&&Array.isArray(t.templates))a=t.templates;else if(t.data&&Array.isArray(t.data))a=t.data;else{console.warn("Unexpected templates response structure, using fallback contract types");return}let s=a.map(e=>({value:(e.name||e.id||e.type||"").toLowerCase(),label:e.description||e.name||e.type||"Unknown Template"}));console.log("Mapped templates:",s),C(s.length>0?s:k)}catch(e){console.error("Template fetch error:",e),N(e.message||"Failed to load contract types, using fallback options")}},U=async()=>{try{let e=await fetch("/api/session/create",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=e.headers.get("Content-Type"),a="Failed to create session";throw a=t?.includes("application/json")?(await e.json()).error||a:`${a} (Status: ${e.status} ${e.statusText})`,Error(a)}let t=await e.json();if(!t.session_id)throw Error("Session ID not returned");console.log("Session created:",t.session_id),w(t.session_id)}catch(e){console.error("Session creation error:",e),N(e.message||"An unexpected error occurred during session creation")}},T=async s=>{let r=s.target.files?.[0];if(r){if(console.log("File uploaded:",{name:r.name,type:r.type,size:r.size}),m(r),A(null),N(null),P(!0),e&&e.type!==x&&(console.log("Clearing reviewDocument, preserving contractType:",x),t(null)),b||(console.log("No session ID, creating new session"),await U()),!x){N("Please select a contract type before uploading the document."),P(!1);return}if(!b){N("Session could not be created. Please try again."),P(!1);return}try{let e;let s=new FormData;s.append("file",r),s.append("template_type",x),s.append("session_id",b),console.log("Sending upload request with:",{template_type:x,session_id:b,file_name:r.name});let l=await fetch("/api/contracts/upload-for-review",{method:"POST",body:s}),n=l.headers.get("Content-Type");if(e=n?.includes("application/json")?await l.json():{text:await l.text()},console.log("Upload response:",{status:l.status,ok:l.ok,data:e}),!l.ok){let t=e.error||e.details||"Failed to upload document";throw n?.includes("application/json")||(t=`Failed to upload document (Status: ${l.status} ${l.statusText})`),Error(t)}if(!e.message)throw Error("Unexpected response format: No message field");A(e),console.log("Upload successful, response set:",e);let o={id:`upload_${Date.now()}`,name:r.name.replace(/\.[^/.]+$/,""),type:x,content:null,metadata:{template_type:x,enterprise_name:"",client_name:"",effective_date:"",valid_duration:"",notice_period:"",generatedAt:new Date().toISOString(),session_id:b,uploadedAt:new Date().toISOString()},file:r};t(o),a(o)}catch(e){console.error("Upload error:",e.message),N(e.message||"Failed to upload document. Please try again."),m(null),A(null)}finally{P(!1)}}},Z=async()=>{if(!p||!x||!b){N("Please upload a document, select a contract type, and ensure a session is active.");return}if(console.log("Analyzing contract, uploadResponse:",_),!_){N("Document upload not completed. Please upload the document again.");return}if(!["File uploaded successfully","Upload successful","Document uploaded"].includes(_.message)){N(`Upload issue: ${_.message||"Unknown error"}. Please upload the document again.`);return}v(!0),N(null);let s=0,r=null;for(;s<3;)try{let e=new URLSearchParams;e.append("session_id",b);let t=await fetch("/api/contracts/evaluate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:e});if(!t.ok){let e=t.headers.get("Content-Type"),a="Failed to evaluate contract";if(e?.includes("application/json")){let e=await t.json();a=e.error||e.details||a}else a=`${a} (Status: ${t.status} ${t.statusText})`;throw Error(a)}r=await t.json(),console.log("Evaluation response:",r);break}catch(e){if(3==++s){console.error("Max retries reached. Evaluation failed:",e),N("Failed to evaluate the contract after multiple attempts. Please try again or contact support."),v(!1);return}await new Promise(e=>setTimeout(e,1e3*s))}try{if(r){let{questions:s,answers:l}=r,n=s.map((e,t)=>{let a=l[t]||"No answer provided.",s="good";return a.includes("NA - Not Applicable")||a.startsWith("No")?s="good":a.includes("partially")||a.includes("could be")?s="warning":(a.includes("issue")||a.includes("excessive"))&&(s="critical"),{id:String(t),question:e,answer:a,status:s}});f(n);let o={id:e?.id||`analyzed_${Date.now()}`,name:p.name.replace(/\.[^/.]+$/,""),type:x,content:e?.content||null,metadata:{template_type:x,enterprise_name:e?.metadata.enterprise_name||"",client_name:e?.metadata.client_name||"",effective_date:e?.metadata.effective_date||"",valid_duration:e?.metadata.valid_duration||"",notice_period:e?.metadata.notice_period||"",generatedAt:e?.metadata.generatedAt||new Date().toISOString(),session_id:b,analyzedAt:new Date().toISOString()},file:p,evaluation:n};a(o),t(o)}}catch(e){console.error("Evaluation processing error:",e),N(e.message||"Failed to process the evaluation results. Please try again or contact support.")}finally{v(!1)}},F=e=>{switch(e){case"good":return s.jsx(l.Z,{className:"w-5 h-5 text-green-500"});case"warning":return s.jsx(n,{className:"w-5 h-5 text-yellow-500"});case"critical":return s.jsx(n,{className:"w-5 h-5 text-red-500"});default:return null}};return s.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200",children:(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-8",children:[s.jsx("div",{className:"bg-teal-500 w-12 h-12 rounded-lg flex items-center justify-center",children:s.jsx(o.Z,{className:"w-6 h-6 text-white"})}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Evaluate Contract"}),s.jsx("p",{className:"text-gray-600",children:"Analyze contracts with AI-powered evaluation"})]})]}),e&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(i.Z,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-blue-800",children:"Document from Generation"})]}),(0,s.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["Ready to analyze: ",e.name," (",k.find(t=>t.value===e.type)?.label||e.type,")"]})]}),j&&s.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(d.Z,{className:"w-5 h-5 text-red-600"}),s.jsx("span",{className:"text-sm text-red-700",children:j})]})}),(0,s.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Contract Type ",s.jsx("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)("select",{value:x,onChange:e=>{console.log("Contract type selected:",e.target.value),h(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-emphasis",required:!0,children:[s.jsx("option",{value:"",children:"Select contract type"}),k.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))]})]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-teal-400 transition-colors",children:[s.jsx(c.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Upload Contract Document"}),s.jsx("p",{className:"text-gray-600 mb-3",children:"Support for Word (.doc, .docx), PDF, and text (.txt) files"}),s.jsx("input",{type:"file",accept:".doc,.docx,.pdf,.txt",onChange:T,className:"hidden",id:"file-upload",ref:D}),s.jsx("button",{type:"button",onClick:()=>{D.current&&D.current.click()},disabled:S,className:"px-6 py-2 text-white bg-teal-600 rounded-lg font-semibold hover:bg-teal-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:S?"Uploading...":"Choose File"}),p&&s.jsx("div",{className:"mt-4 p-3 bg-teal-50 border border-gray-200 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(i.Z,{className:"w-4 h-4 text-teal-600"}),s.jsx("span",{className:"text-sm text-teal-800 truncate",children:p.name})]})})]}),s.jsx("button",{onClick:Z,disabled:g||S||!p||!x||!b||!_?.message,className:"w-full mt-4 py-3 px-6 text-white bg-teal-700 rounded-lg font-semibold hover:bg-teal-800 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:g?(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Analyzing Contract..."})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(o.Z,{className:"w-5 h-5"}),s.jsx("span",{children:"Analyze Contract"})]})})]}),(0,s.jsxs)("div",{children:[y.length>0&&(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contract Evaluation Results"}),s.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:y.map(e=>s.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-white shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[F(e.status),(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:e.question}),s.jsx("p",{className:"text-sm text-gray-600",children:e.answer})]})]})},e.id))})]}),0===y.length&&!g&&(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx(o.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Analyze"}),s.jsx("p",{className:"text-gray-600",children:"Upload a contract document and select its type to get started"})]})]})]})]})})})}},361:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3685:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},4019:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},218:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c,metadata:()=>d});var s=a(9510),r=a(5384),l=a.n(r);a(7272);var n=a(8570);let o=(0,n.createProxy)(String.raw`/Users/varun/work/ARC_Next/app/contexts/DocumentContext.tsx#DocumentProvider`);(0,n.createProxy)(String.raw`/Users/varun/work/ARC_Next/app/contexts/DocumentContext.tsx#useDocuments`);let i=(0,n.createProxy)(String.raw`/Users/varun/work/ARC_Next/app/components/Header.tsx#default`),d={title:"ARC Legal Documents Application",description:"Streamline your legal document workflows with AI-powered generation, review, and comparison tools"};function c({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:l().className,children:s.jsx(o,{children:(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(i,{}),e]})})})})}},1239:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`/Users/varun/work/ARC_Next/app/review/page.tsx#default`)},7272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[276,127],()=>a(5227));module.exports=s})();